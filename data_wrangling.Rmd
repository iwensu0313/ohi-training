---
title: "Data Wrangling Training"
author: "Iwen Su"
date: "3/6/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Intro to Data Wrangling

### Wrangle gapminder data using `dplyr`.

First load the packages.

```{r load, message=FALSE}

library(tidyverse)
library(skimr)

```

Get data from github.

```{r data, message=FALSE}

gapminder <- readr::read_csv("https://raw.githubusercontent.com/OHI-Science/data-science-training/master/data/gapminder.csv")

```

Explore gapminder data.

```{r explore}

head(gapminder)
tail(gapminder)

head(gapminder, 10) # see the first ten rows
tail(gapminder, 12) # see the last twelve rows

## See structure and other info about the data frame
str(gapminder)
names(gapminder) 
dim(gapminder) 
c(nrow(gapminder), ncol(gapminder)) # create dim() from nrow() and ncol()

## summary statistics
summary(gapminder)
skim(gapminder) 


```

> Note: In addition to what data.frames can store, tibble can store lists, ggplots, and multiple dataframes.

Explore inside the dataframe `$`

```{r}

head(gapminder$lifeExp, 10)
str(gapminder$lifeExp) # more useful function for looking at entire dataset
summary(gapminder$lifeExp)
skim(gapminder$lifeExp)

```

### Dplyr basics: 

Main functions include: `filter()`, `select()`, `mutate()`, `summarise()`, and `arrange()`. See dplyr [cheatsheet](http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf).

```{r}

filter(gapminder, lifeExp < 29)

# Filter for 1 country
filter(gapminder, country == "Mexico")

# Filter for multiple countries - use the `%in%` operator on `c()`
filter(gapminder, country %in% c("Mexico", "Chile"))

# Filter for 1 country in a specific year
filter(gapminder, country == "Mexico", year == 2002)

# Select by columns
select(gapminder, year, lifeExp)

# Use the `-` to deselect columns
select(gapminder, -continent, -lifeExp)

# Use filter and select together
gap_cambodia <- filter(gapminder, country == "Cambodia") 
gap_cambodia2 <- select(gap_cambodia, -lifeExp, -continent)

```

Life changing pipe operator `%>%` (and then)

```{r}

gapminder %>% head() # equivalent to head(gapminder)

gapminder %>% head(3) # equivalent to head(gapminder, 3)

# Use filter and select together 
gap_cambodia <- filter(gapminder, country == "Cambodia") 
gap_cambodia2 <- select(gap_cambodia, -lifeExp, -continent)

# now let's do that with the %>% operator
gap_cambodia <- gapminder %>% 
  filter(country == "Cambodia")

gap_cambodia2 <- gap_cambodia %>% 
  select(-lifeExp, -continent)

# or you could combine the two variables created above by stacking `%>%` operators
gap_cambodia3 <- gapminder %>% 
  filter(country == "Cambodia") %>% 
  select(-continent, -lifeExp)

```

To add variables use `mutate()`

```{r}



```

